–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ5

–¢–µ–º–∞: –ü—Ä–æ–≥—Ä–∞–º–Ω—ñ –∫–∞–Ω–∞–ª–∏ PIPE —Ç–∞ FIFO
–ú–µ—Ç–∞: –û–∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—è –∑ –º–µ—Ö–∞–Ω—ñ–∑–º–æ–º –º—ñ–∂–ø—Ä–æ—Ü–µ—Å–Ω–æ—ó –≤–∑–∞—î–º–æ–¥—ñ—ó –≤ Linux –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–µ—ñ–º–µ–Ω–æ–≤–∞–Ω–∏—Ö —ñ–º–µ–Ω–æ–≤–∞–Ω–∏—Ö –∫–∞–Ω–∞–ª—ñ–≤, –Ω–∞–≤—á–∏—Ç–∏—Å—è –æ—Ä–≥–∞–Ω—ñ–∑–æ–≤—É–≤–∞—Ç–∏ –æ–±–º—ñ–Ω –¥–∞–Ω–∏–º–∏ –º—ñ–∂ –ø—Ä–æ—Ü–µ—Å–∞–º–∏.

–ó–∞–≤–¥–∞–Ω–Ω—è 1 ‚Äî –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ—Ü–µ—Å—ñ–≤ —á–µ—Ä–µ–∑ –Ω–µ—ñ–º–µ–Ω–æ–≤–∞–Ω–∏–π pipe
–£–º–æ–≤–∞

–ü—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è n –¥–æ—á—ñ—Ä–Ω—ñ—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é fork(), –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏, —â–æ–± —Å–ø–æ—á–∞—Ç–∫—É –ø—Ä–∞—Ü—é–≤–∞–ª–∏ –≤—Å—ñ –¥—ñ—Ç–∏, –∞ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–∏–π –ø—Ä–æ—Ü–µ—Å –ø—Ä–æ–¥–æ–≤–∂–∏–≤ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ª–∏—à–µ –ø—ñ—Å–ª—è —ó—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è.

–ü—Ä–∏–Ω—Ü–∏–ø —Ä–æ–±–æ—Ç–∏

–°—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∫–∞–Ω–∞–ª pipe(fds).

–ö–æ–∂–Ω–∞ –¥–∏—Ç–∏–Ω–∞ –ø—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ –∑–∞–ø–∏—Å—É—î 1 –±–∞–π—Ç —É –∫–∞–Ω–∞–ª.

–ë–∞—Ç—å–∫–æ —á–∏—Ç–∞—î –∑ fds[0] —Ä—ñ–≤–Ω–æ n –±–∞–π—Ç—ñ–≤ ‚Äî –ø—ñ—Å–ª—è —Ü—å–æ–≥–æ –ø—Ä–æ–¥–æ–≤–∂—É—î —Ä–æ–±–æ—Ç—É.

–ö–æ–º–ø—ñ–ª—è—Ü—ñ—è —Ç–∞ –∑–∞–ø—É—Å–∫
make
./bin/task1 3

–ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
[parent pid=5627] forking 3 children...
[child 0 | pid=5628] work done after 340 ms
[child 2 | pid=5630] work done after 494 ms
[child 1 | pid=5629] work done after 649 ms
[parent] received 3/3 tokens
Parent final action: ALL children finished. 

–ó–∞–≤–¥–∞–Ω–Ω—è 2 ‚Äî –î–≤–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∑–≤‚Äô—è–∑–æ–∫ –º—ñ–∂ –±–∞—Ç—å–∫–æ–º —ñ –¥–∏—Ç–∏–Ω–æ—é —á–µ—Ä–µ–∑ pipe
–£–º–æ–≤–∞

–†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π –æ–±–º—ñ–Ω –¥–∞–Ω–∏–º–∏ –º—ñ–∂ –±–∞—Ç—å–∫–æ–º —ñ –¥–æ—á—ñ—Ä–Ω—ñ–º –ø—Ä–æ—Ü–µ—Å–æ–º:

–ë–∞—Ç—å–∫–æ –≤–≤–æ–¥–∏—Ç—å —Ä—è–¥–∫–∏ –∑ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏.

–ù–∞–¥—Å–∏–ª–∞—î —Ä—è–¥–æ–∫ –¥–æ—á—ñ—Ä–Ω—å–æ–º—É –ø—Ä–æ—Ü–µ—Å—É.

–î–∏—Ç–∏–Ω–∞ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å —Ç–µ–∫—Å—Ç —É –≤–µ—Ä—Ö–Ω—ñ–π —Ä–µ–≥—ñ—Å—Ç—Ä —ñ –ø–æ–≤–µ—Ä—Ç–∞—î –π–æ–≥–æ –Ω–∞–∑–∞–¥.

–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è –∑–∞ –∫–æ–º–∞–Ω–¥–æ—é stop.

–°—Ö–µ–º–∞ –∑–≤‚Äô—è–∑–∫—É
parent ‚Üí pipe1 ‚Üí child
child  ‚Üí pipe2 ‚Üí parent

–ö–æ–º–ø—ñ–ª—è—Ü—ñ—è —Ç–∞ –∑–∞–ø—É—Å–∫
make
./bin/task2

–ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
Enter text (stop to exit): hello world
Child: HELLO WORLD
Enter text (stop to exit): test
Child: TEST
Enter text (stop to exit): stop

–ó–∞–≤–¥–∞–Ω–Ω—è 3 ‚Äî –î–≤–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∑–≤‚Äô—è–∑–æ–∫ –º—ñ–∂ –ø—Ä–æ—Ü–µ—Å–∞–º–∏ —á–µ—Ä–µ–∑ —ñ–º–µ–Ω–æ–≤–∞–Ω—ñ –∫–∞–Ω–∞–ª–∏ FIFO
–£–º–æ–≤–∞

–û—Ä–≥–∞–Ω—ñ–∑—É–≤–∞—Ç–∏ –æ–±–º—ñ–Ω –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏ –º—ñ–∂ –¥–≤–æ–º–∞ –Ω–µ–∑–∞–ª–µ–∂–Ω–∏–º–∏ –ø—Ä–æ—Ü–µ—Å–∞–º–∏ (–Ω–µ —Å–ø–æ—Ä—ñ–¥–Ω–µ–Ω–∏–º–∏) –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —ñ–º–µ–Ω–æ–≤–∞–Ω–∏—Ö –∫–∞–Ω–∞–ª—ñ–≤ FIFO.

–°—Ö–µ–º–∞ –∑–≤‚Äô—è–∑–∫—É
writer ‚Üí fifo1 ‚Üí reader
reader ‚Üí fifo2 ‚Üí writer

–§–∞–π–ª–∏

fifo1, fifo2 ‚Äî —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É.

writer ‚Äî –Ω–∞–¥—Å–∏–ª–∞—î —Ç–µ–∫—Å—Ç —ñ –æ—Ç—Ä–∏–º—É—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å.

reader ‚Äî –ø—Ä–∏–π–º–∞—î —Ç–µ–∫—Å—Ç, –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å —É –≤–µ—Ä—Ö–Ω—ñ–π —Ä–µ–≥—ñ—Å—Ç—Ä —ñ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –Ω–∞–∑–∞–¥.

–ö–æ–º–ø—ñ–ª—è—Ü—ñ—è
make

–ó–∞–ø—É—Å–∫ —É –¥–≤–æ—Ö —Ç–µ—Ä–º—ñ–Ω–∞–ª–∞—Ö

–¢–µ—Ä–º—ñ–Ω–∞–ª 1:

./bin/task3 reader


–¢–µ—Ä–º—ñ–Ω–∞–ª 2:

./bin/task3 writer

–ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
Enter text (stop to exit): hi
Reader: HI
Enter text (stop to exit): fgsh
Reader: FGSH
Enter text (stop to exit): stop

üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
lb5/
‚îú‚îÄ‚îÄ task1/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ include/
‚îÇ   ‚îú‚îÄ‚îÄ Makefile
‚îÇ   ‚îî‚îÄ‚îÄ bin/task1
‚îú‚îÄ‚îÄ task2/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ include/
‚îÇ   ‚îú‚îÄ‚îÄ Makefile
‚îÇ   ‚îî‚îÄ‚îÄ bin/task2
‚îî‚îÄ‚îÄ task3/
    ‚îú‚îÄ‚îÄ src/
    ‚îú‚îÄ‚îÄ include/
    ‚îú‚îÄ‚îÄ Makefile
    ‚îî‚îÄ‚îÄ bin/task3

–í–∏—Å–Ω–æ–≤–∫–∏

–£ —Ö–æ–¥—ñ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –±—É–ª–æ:

–í–∏–≤—á–µ–Ω–æ –ø—Ä–∏–Ω—Ü–∏–ø —Ä–æ–±–æ—Ç–∏ –Ω–µ—ñ–º–µ–Ω–æ–≤–∞–Ω–∏—Ö —ñ–º–µ–Ω–æ–≤–∞–Ω–∏—Ö –∫–∞–Ω–∞–ª—ñ–≤ —É Linux.

–†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —Ç—Ä–∏ —Ç–∏–ø–∏ –º—ñ–∂–ø—Ä–æ—Ü–µ—Å–Ω–æ—ó –≤–∑–∞—î–º–æ–¥—ñ—ó:

–û–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è —á–µ—Ä–µ–∑ pipe.

–î–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π –æ–±–º—ñ–Ω –º—ñ–∂ –±–∞—Ç—å–∫–æ–º —ñ –¥–∏—Ç–∏–Ω–æ—é —á–µ—Ä–µ–∑ –¥–≤–∞ pipe.

–î–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π –æ–±–º—ñ–Ω –º—ñ–∂ –Ω–µ–∑–∞–ª–µ–∂–Ω–∏–º–∏ –ø—Ä–æ—Ü–µ—Å–∞–º–∏ —á–µ—Ä–µ–∑ FIFO.

–û—Ç—Ä–∏–º–∞–Ω–æ –ø—Ä–∞–∫—Ç–∏—á–Ω—ñ –Ω–∞–≤–∏—á–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –ø—Ä–æ—Ü–µ—Å—ñ–≤, —Ä–æ–±–æ—Ç–∏ –∑ —Ñ–∞–π–ª–æ–≤–∏–º–∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞–º–∏ —Ç–∞ –ø–µ—Ä–µ–¥–∞—á—ñ –¥–∞–Ω–∏—Ö –º—ñ–∂ –ø—Ä–æ—Ü–µ—Å–∞–º–∏.